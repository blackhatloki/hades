 object modify -s FILESYSTEMS="mountpoint=/boot:dev=sda1:type=ext3:size=500,dev=sda2:type=swap:size=32768,mountpoint=/:dev=sda3:type=ext3:size=fill" node0000

 mountpoint=/boot:dev=sda1:type=ext4:size=512,dev=sda2:type=swap:size=2048,mountpoint=/:dev=sda3:type=ext4:size=65536,mountpoint=/state/partition1:dev=sda4:type=ext4:size=fill


 object modify -s FILESYSTEMS="mountpoint=/boot:dev=sda1:type=ext4:size=512,dev=sda2:type=swap:size=2048,mountpoint=/:dev=sda3:type=ext4:size=fill,mountpoint=/state/partition1:dev=sdb1:type=ext4:size=fill" phi-01-02
 object modify -s FILESYSTEMS="mountpoint=/boot:dev=sda1:type=ext4:size=512,dev=sda2:type=swap:size=2048,mountpoint=/:dev=sda3:type=ext4:size=fill,mountpoint=/state/partition1:dev=sdb1:type=ext4:size=fill" phi-01-04


 objects
   bootloader=sda                                          # which disk to install grub to
   diskpartition=sda                                       # which disks to partition
   diskformat=sda1                                         # which partitions to format
   filesystems=mountpoint=/:dev=sda1:type=ext2:size=20480  # specify the filesystem scheme, size=MB
  
   object modify -s diskpartition="sda,sdb" phi-01-02
   object modify -s diskformat="sda1,sda2,sda3,sda4,sdb1"  phi-01-02 
   object modify -s FILESYSTEMS="mountpoint=/boot:dev=sda1:type=ext4:size=512,dev=sda2:type=swap:size=2048,mountpoint=/:dev=sda3:type=ext4:size=fill,mountpoint=/state/partition1:dev=sdb1:type=ext4:size=fill" phi-01-02
   
   object print -s diskpartition phi-01-02
   NAME                       DISKPARTITION
======================================================
phi-01-02                  sda
   object print -s diskformat phi-01-02
   Warewulf> object print -s diskformat phi-01-02
NAME                       DISKFORMAT
======================================================
phi-01-02                  sda1,sda2,sda3,sda4 


 object print -p :all


Building the chroot and vnfs

The chroot generated by wwmkchroot currently cannot be used directly for stateful provisioning as it lacks a kernel and grub installation. This can be solved by modifying the wwmkchroot script, or by simply installing those packages into the chroot before bundling the vnfs:

yum --installroot=/var/chroots/rhel-5-stateful install kernel grub
Then re-import the vnfs with these changes:

sudo wwvnfs --chroot /var/chroots/rhel-5-stateful
Also, in older revisions of Warewulf, the default "excludes" list in /etc/warewulf/vnfs.conf excludes the grub files in /usr/share/grub. (Newer revisions do not have this problem.) Make sure that the "excludes" list will not remove any of the grub or kernel files.

Node configuration Â¶
